#include <stdio.h>

int main() {
    int t;
    if (scanf("%d", &t) != 1) return 0;
    while (t--) {
        int n, k;
        scanf("%d %d", &n, &k);
        int arr[n];
        long long array_sum = 0;
        
        for (int i = 0; i < n; i++) {
            scanf("%d", &arr[i]);
            array_sum += arr[i];
        }

        long long current_sum = 0;
        long long max_so_far = -1e6; 


        int limit = (k == 1) ? n : 2 * n;

        for (int i = 0; i < limit; i++) {
            current_sum += arr[i % n];
            
            if (current_sum > max_so_far) {
                max_so_far = current_sum;
            }
            
            if (current_sum < 0) {
                current_sum = 0;
            }
        }


        if (k > 2 && array_sum > 0) {
            max_so_far += (long long)(k - 2) * array_sum;
        }

        printf("%lld\n", max_so_far);
    }
}